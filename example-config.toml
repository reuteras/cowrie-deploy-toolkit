# Cowrie Honeypot Deployment - Master Configuration
#
# This is an example configuration file. Copy to master-config.toml and customize.
# Commands starting with "op read" will be executed to fetch secrets from 1Password.
#
# Multi-Honeypot Support
# ======================
# Deploy multiple honeypots from a single configuration file.
# Define shared settings once, then specify unique settings per honeypot.
#
# Usage:
#   cp example-config.toml master-config.toml
#   # Edit master-config.toml with your settings
#   ./generate_cowrie_fs_from_hetzner.sh  # Generate filesystem once
#   ./deploy_cowrie_honeypot.sh ./output_YYYYMMDD_HHMMSS --name cowrie-hp-1  # Deploy specific
#   ./deploy_cowrie_honeypot.sh ./output_YYYYMMDD_HHMMSS --all  # Deploy all

# =============================================================================
# SHARED SETTINGS (Applied to all honeypots)
# =============================================================================

[shared.deployment]
# Hetzner Cloud settings for all servers
server_type = "cx23"

# OS Version Configuration (NEW in v2.1)
generation_image = "debian-13"   # OS to capture filesystem FROM (what attackers see)
deployment_image = "debian-13"   # OS to deploy honeypot ON (actual running server)

# SSH keys registered in your Hetzner account (required for server access)
# Update these to match your SSH key names from: hcloud ssh-key list
ssh_keys = ["SSH Key One", "SSH Key Two"]

[shared.tailscale]
# Tailscale VPN (REQUIRED in v2.1)
# Auth key is shared across all honeypots - generate at:
# https://login.tailscale.com/admin/settings/keys
authkey = ""  # REQUIRED - add your authkey here
# Or fetch from 1Password: "op read op://Personal/Tailscale/honeypot_authkey"

# Your Tailscale domain (tailnet name) - REQUIRED
# Find at: https://login.tailscale.com/admin/dns
# Example: "tail12345.ts.net"
tailscale_domain = ""  # REQUIRED - add your Tailscale domain here

# Use Tailscale SSH (optional, experimental)
use_tailscale_ssh = false

# Auto-cleanup old Tailscale devices (prevents name-1, name-2 suffixes)
# Requires a Tailscale API key with device:delete scope
# Generate at: https://login.tailscale.com/admin/settings/keys
auto_cleanup_old_devices = false
tailscale_api_key = ""  # Optional - only needed if auto_cleanup_old_devices = true
# Or: "op read op://Personal/Tailscale/api_key"

[shared.honeypot]
# Enable automated daily reporting (set to false to skip reporting setup)
enable_reporting = true

# MaxMind GeoIP credentials (free account: https://www.maxmind.com/en/geolite2/signup)
maxmind_account_id = "YOUR_ACCOUNT_ID"
# Or: "op read op://Personal/MaxMind/account_id"
maxmind_license_key = "YOUR_LICENSE_KEY"
# Or: "op read op://Personal/MaxMind/license_key"

[shared.reporting]
# Number of commands to show per session before "... and X more" (default: 20)
max_commands_per_session = 20

# VirusTotal API key (free: https://www.virustotal.com/)
virustotal_api_key = "YOUR_VT_API_KEY"
# Or: "op read op://Personal/VirusTotal/api_key"

# Report recipients
email_from = "honeypot@yourdomain.com"
email_to = "admin@yourdomain.com"
email_subject_prefix = "[Honeypot]"

[shared.email]
# Scaleway Transactional Email settings
scaleway_domain = "yourdomain.com"
smtp_host = "smtp.tem.scw.cloud"
smtp_port = 587
smtp_user = "YOUR_SMTP_USERNAME"
# Or: "op read op://Personal/Scaleway/smtp_user"
smtp_password = "YOUR_SMTP_PASSWORD"
# Or: "op read op://Personal/Scaleway/smtp_password"
smtp_tls = true

[shared.data_sharing]
# AbuseIPDB - Report and query IP reputation data
abuseipdb_enabled = false
abuseipdb_api_key = ""
abuseipdb_tolerance_attempts = 10
abuseipdb_tolerance_window = 120
abuseipdb_rereport_after = 24

# DShield (SANS Internet Storm Center)
dshield_enabled = false
dshield_userid = ""
dshield_auth_key = ""
dshield_batch_size = 10



[shared.canary_webhook]
# Canary Token Webhook Receiver
enabled = false

[shared.advanced]
# Report generation interval (hours)
report_hours = 24

# =============================================================================
# HONEYPOT DEFINITIONS (Unique settings per honeypot)
# =============================================================================

# Example 1: Single honeypot with local dashboard (simplest setup)
# ------------------------------------------------------------------
[[honeypots]]
name = "cowrie-honeypot"        # Tailscale hostname (unique identifier)
hostname = "dmz-web01"           # System hostname shown to attackers
location = "hel1"                # Hetzner datacenter: hel1 (Helsinki), fsn1 (Falkenstein), nbg1 (Nuremberg), ash (Ashburn)
api_enabled = true               # Enable API for potential future multi-host
api_expose_via_tailscale = false # Don't expose API (local dashboard only)
dashboard_enabled = true         # Enable web dashboard
dashboard_mode = "local"         # Direct file access (same server)


# Example 2: Two honeypots with centralized dashboard
# -----------------------------------------------------
# Uncomment and customize these examples for multi-honeypot deployment:

# [[honeypots]]
# name = "cowrie-hp-1"            # Tailscale hostname
# hostname = "dmz-web-01"          # System hostname shown to attackers
# location = "hel1"                # Helsinki, Finland
# api_enabled = true               # Enable API
# api_expose_via_tailscale = true  # Expose API via Tailscale for dashboard access
# dashboard_enabled = true         # Also run dashboard on this server
# dashboard_mode = "multi"         # Aggregate data from multiple sources
# dashboard_sources = ["cowrie-hp-1", "cowrie-hp-2"]  # References by name

# [[honeypots]]
# name = "cowrie-hp-2"
# hostname = "dmz-db-01"
# location = "fsn1"                # Falkenstein, Germany
# api_enabled = true
# api_expose_via_tailscale = true
# dashboard_enabled = false        # No dashboard on this server


# Example 3: Two honeypots + separate dashboard server
# ------------------------------------------------------

# [[honeypots]]
# name = "cowrie-hp-1"
# hostname = "dmz-web-01"
# api_enabled = true
# api_expose_via_tailscale = true
# dashboard_enabled = false

# [[honeypots]]
# name = "cowrie-hp-2"
# hostname = "dmz-db-01"
# api_enabled = true
# api_expose_via_tailscale = true
# dashboard_enabled = false

# [[honeypots]]
# name = "cowrie-dashboard"
# hostname = "dashboard"
# api_enabled = false              # Dashboard doesn't need its own API
# dashboard_enabled = true
# dashboard_mode = "multi"
# dashboard_sources = ["cowrie-hp-1", "cowrie-hp-2"]


# Example 4: Mixed honeypot types (future extensibility)
# --------------------------------------------------------

# [[honeypots]]
# name = "cowrie-ssh"
# hostname = "dmz-ssh-01"
# api_enabled = true
# api_expose_via_tailscale = true
# dashboard_enabled = false

# [[honeypots]]
# name = "web-honeypot"
# hostname = "dmz-web-01"
# api_enabled = true
# api_expose_via_tailscale = true
# dashboard_enabled = false

# [[honeypots]]
# name = "dashboard"
# hostname = "dashboard"
# api_enabled = false
# dashboard_enabled = true
# dashboard_mode = "multi"
# dashboard_sources = [
#     {name = "cowrie-ssh", type = "cowrie-ssh"},
#     {name = "web-honeypot", type = "web-honeypot"}
# ]


